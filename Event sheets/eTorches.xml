<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>eTorches</name>
    <events>
        <event-block sid="373035939538031">
            <conditions>
                <condition id="-2" name="On start of layout" sid="809720603553199" type="System" />
            </conditions>
            <actions>
                <action id="-3" name="Set position" sid="387436926462636" type="spr_fire">
                    <param id="0" name="X">spr_torch.X</param>
                    <param id="1" name="Y">spr_torch.Y - 14</param>
                </action>
                <action id="-15" name="Set visible" sid="931521582383589" type="spr_fire">
                    <param id="0" name="Visibility">0</param>
                </action>
                <action id="-3" name="Set position" sid="683712763742627" type="spr_torch_light">
                    <param id="0" name="X">spr_torch.X</param>
                    <param id="1" name="Y">spr_torch.Y - 23</param>
                </action>
                <action id="-15" name="Set visible" sid="156356898952608" type="spr_torch_light">
                    <param id="0" name="Visibility">0</param>
                </action>
                <action id="-26" name="Move to layer" sid="373045411630887" type="spr_torch_light">
                    <param id="0" name="Layer">&quot;black&quot;</param>
                </action>
            </actions>
            <sub-events>
                <event-block sid="707268497198878">
                    <conditions>
                        <condition id="-11" name="For Each" sid="545369411996697" type="System">
                            <param id="0" name="Object">spr_torch</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="124941715296278">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="826709726126840" type="spr_torch">
                                    <param id="0" name="Instance variable">type</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;normal&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="403613811393205">
                                    <conditions>
                                        <condition id="-8" name="Is boolean instance variable set" sid="674429222694183" type="spr_torch">
                                            <param id="0" name="Instance variable">is_lit</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-15" name="Set visible" sid="710681928237465" type="spr_torch_light">
                                            <param id="0" name="Visibility">1</param>
                                        </action>
                                        <action id="-15" name="Set visible" sid="137813391040945" type="spr_fire">
                                            <param id="0" name="Visibility">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="685647536572000">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="798037588466128" type="spr_torch">
                                    <param id="0" name="Instance variable">type</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;long_distance&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="4" name="Set animation" sid="498162747849453" type="spr_torch">
                                    <param id="0" name="Animation">&quot;long_distance&quot;</param>
                                    <param id="1" name="From">1</param>
                                </action>
                                <action id="9" name="Set scale" sid="774024152904044" type="spr_torch">
                                    <param id="0" name="Scale">1.5</param>
                                </action>
                                <action id="9" name="Set scale" sid="530042048266643" type="spr_fire">
                                    <param id="0" name="Scale">1.5</param>
                                </action>
                                <action id="9" name="Set scale" sid="214161556857232" type="spr_torch_light">
                                    <param id="0" name="Scale">1.5</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="965144510836147">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="546158243242049" type="spr_torch">
                                    <param id="0" name="Instance variable">type</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;timed&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="4" name="Set animation" sid="271576559336416" type="spr_torch">
                                    <param id="0" name="Animation">&quot;timed&quot;</param>
                                    <param id="1" name="From">1</param>
                                </action>
                                <action id="-16" name="Set opacity" sid="439279953824657" type="spr_torch_light">
                                    <param id="0" name="Opacity">50</param>
                                </action>
                                <action id="9" name="Set scale" sid="397617467240813" type="spr_torch_light">
                                    <param id="0" name="Scale">0.5</param>
                                </action>
                                <action id="9" name="Set scale" sid="388780592332420" type="spr_fire">
                                    <param id="0" name="Scale">0.5</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-block>
        <comment>Called from ePlayer.</comment>
        <event-block sid="812889329473886">
            <conditions>
                <condition id="0" name="On function" sid="285486436286647" type="Function">
                    <param id="0" name="Name">&quot;eTorches.Light_Torch&quot;</param>
                </condition>
            </conditions>
            <actions />
            <sub-events>
                <comment>0 - UID of the torch</comment>
                <event-block sid="697032662613953">
                    <conditions>
                        <condition id="-14" name="Pick by unique ID" sid="764410015337826" type="spr_torch">
                            <param id="0" name="Unique ID">Function.Param(0)</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="696203897464312">
                            <conditions>
                                <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="557148427583896" type="spr_torch">
                                    <param id="0" name="Instance variable">is_lit</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-15" name="Set visible" sid="807789878350251" type="spr_torch_light">
                                    <param id="0" name="Visibility">1</param>
                                </action>
                                <action id="-15" name="Set visible" sid="946697962273851" type="spr_fire">
                                    <param id="0" name="Visibility">1</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="853604448295271">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="768995961947821" type="spr_torch">
                                            <param id="0" name="Instance variable">type</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;normal&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-13" name="Set boolean" sid="122722391248148" type="spr_torch">
                                            <param id="0" name="Instance variable">is_lit</param>
                                            <param id="1" name="Value">1</param>
                                        </action>
                                        <action id="0" name="Call function" sid="496910813936497" type="Function">
                                            <param id="0" name="Name">&quot;eEvents/Respawn.Add_Event&quot;</param>
                                            <param id="1" name="Parameter {n}">&quot;torch_&quot; &amp; spr_torch.UID</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="493738788304959">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="596736321893468" type="spr_torch">
                                            <param id="0" name="Instance variable">type</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;long_distance&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-13" name="Set boolean" sid="654632094863761" type="spr_torch">
                                            <param id="0" name="Instance variable">is_lit</param>
                                            <param id="1" name="Value">1</param>
                                        </action>
                                        <action id="0" name="Call function" sid="238832610539687" type="Function">
                                            <param id="0" name="Name">&quot;eEvents/Respawn.Add_Event&quot;</param>
                                            <param id="1" name="Parameter {n}">&quot;torch_&quot; &amp; spr_torch.UID</param>
                                        </action>
                                        <action id="0" name="Call function" sid="827225109383560" type="Function">
                                            <param id="0" name="Name">&quot;eTorches.Light_Torch&quot;</param>
                                            <param id="1" name="Parameter {n}">spr_torch.long_distance_uid</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="521490670602086">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="164372040520925" type="spr_torch">
                                            <param id="0" name="Instance variable">type</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;timed&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="207331042599624">
                                            <conditions>
                                                <condition id="-14" name="Pick by unique ID" sid="183253757603541" type="obj_timed_torch_handler">
                                                    <param id="0" name="Unique ID">spr_torch.timed_manager_uid</param>
                                                </condition>
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <event-block sid="153402071889804">
                                                    <conditions>
                                                        <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="918986008772578" type="obj_timed_torch_handler">
                                                            <param id="0" name="Instance variable">has_started_timer</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="-13" name="Set boolean" sid="204659014891861" type="obj_timed_torch_handler">
                                                            <param id="0" name="Instance variable">has_started_timer</param>
                                                            <param id="1" name="Value">1</param>
                                                        </action>
                                                        <action behavior="Timer" id="0" name="Start timer" sid="427751542153819" type="obj_timed_torch_handler">
                                                            <param id="0" name="Duration">Self.time_to_light</param>
                                                            <param id="1" name="Type">0</param>
                                                            <param id="2" name="Tag">&quot;light&quot;</param>
                                                        </action>
                                                        <action id="0" name="Call function" sid="290164822220379" type="Function">
                                                            <param id="0" name="Name">&quot;eTorches/TimedTorches.start_flashing&quot;</param>
                                                            <param id="1" name="Parameter {n}">obj_timed_torch_handler.UID</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-block>
        <event-group description="Handles checking and restarting timed torches (but not lighting them)" sid="697712526199578" title="eTorches/TimedTorches">
            <sub-events>
                <event-block sid="149755335622100">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="511063627446522" type="System" />
                    </conditions>
                    <actions>
                        <action id="-15" name="Set visible" sid="915483137497757" type="obj_timed_torch_handler">
                            <param id="0" name="Visibility">0</param>
                        </action>
                    </actions>
                </event-block>
                <event-block sid="643459492567759">
                    <conditions>
                        <condition id="-11" name="For Each" sid="652929645891515" type="System">
                            <param id="0" name="Object">obj_timed_torch_handler</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable comment="True until proven false." constant="0" name="are_all_lit" sid="845333291366478" static="0" type="text">true</variable>
                        <event-block sid="949815230042373">
                            <conditions>
                                <condition id="-10" name="For" sid="214949095763514" type="System">
                                    <param id="0" name="Name">&quot;&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">tokencount(obj_timed_torch_handler.torch_uids, &quot;|&quot;) - 1</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="105534712476728">
                                    <conditions>
                                        <condition id="-14" name="Pick by unique ID" sid="253783079539581" type="spr_torch">
                                            <param id="0" name="Unique ID">int(tokenat(obj_timed_torch_handler.torch_uids, loopindex, &quot;|&quot;))</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="724570984892089">
                                            <conditions>
                                                <condition id="-9" inverted="1" name="Is visible" sid="706816004792665" type="spr_fire" />
                                                <condition id="-9" inverted="1" name="Is visible" sid="167952130883260" type="spr_torch_light" />
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="686090056758419" type="System">
                                                    <param id="0" name="Variable">are_all_lit</param>
                                                    <param id="1" name="Value">&quot;false&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="202432331843648">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="656461172323026" type="System">
                                    <param id="0" name="Variable">are_all_lit</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;true&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="681421281369604">
                                    <conditions>
                                        <condition id="-10" name="For" sid="969785390665225" type="System">
                                            <param id="0" name="Name">&quot;&quot;</param>
                                            <param id="1" name="Start index">0</param>
                                            <param id="2" name="End index">tokencount(obj_timed_torch_handler.torch_uids, &quot;|&quot;) - 1</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="725067485747713">
                                            <conditions>
                                                <condition id="-14" name="Pick by unique ID" sid="804043933960143" type="spr_torch">
                                                    <param id="0" name="Unique ID">int(tokenat(obj_timed_torch_handler.torch_uids, loopindex, &quot;|&quot;))</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-16" name="Set opacity" sid="557733096811701" type="spr_torch_light">
                                                    <param id="0" name="Opacity">100</param>
                                                </action>
                                                <action id="9" name="Set scale" sid="561430273133291" type="spr_torch_light">
                                                    <param id="0" name="Scale">1</param>
                                                </action>
                                                <action id="9" name="Set scale" sid="500121464394464" type="spr_fire">
                                                    <param id="0" name="Scale">1</param>
                                                </action>
                                                <action id="-13" name="Set boolean" sid="816173539815450" type="spr_torch">
                                                    <param id="0" name="Instance variable">is_lit</param>
                                                    <param id="1" name="Value">1</param>
                                                </action>
                                                <action behavior="Flash" id="1" name="Stop flashing" sid="454692011955238" type="spr_torch" />
                                            </actions>
                                        </event-block>
                                        <event-block sid="132255304633026">
                                            <conditions />
                                            <actions>
                                                <action id="-9" name="Destroy" sid="630475826403069" type="obj_timed_torch_handler" />
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="733450070383071">
                            <conditions>
                                <condition behavior="Timer" id="0" name="On timer" sid="253597733371972" type="obj_timed_torch_handler">
                                    <param id="0" name="Tag">&quot;light&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-13" name="Set boolean" sid="578695124152895" type="obj_timed_torch_handler">
                                    <param id="0" name="Instance variable">has_started_timer</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="259281883354634">
                                    <conditions>
                                        <condition id="-10" name="For" sid="928650485246901" type="System">
                                            <param id="0" name="Name">&quot;&quot;</param>
                                            <param id="1" name="Start index">0</param>
                                            <param id="2" name="End index">tokencount(obj_timed_torch_handler.torch_uids, &quot;|&quot;) - 1</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="964019380022875">
                                            <conditions>
                                                <condition id="-14" name="Pick by unique ID" sid="618472336016486" type="spr_torch">
                                                    <param id="0" name="Unique ID">int(tokenat(obj_timed_torch_handler.torch_uids, loopindex, &quot;|&quot;))</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-15" name="Set visible" sid="865301704307241" type="spr_torch_light">
                                                    <param id="0" name="Visibility">0</param>
                                                </action>
                                                <action id="-15" name="Set visible" sid="811048519687338" type="spr_fire">
                                                    <param id="0" name="Visibility">0</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="499990298618532">
                    <conditions>
                        <condition id="0" name="On function" sid="637606162364150" type="Function">
                            <param id="0" name="Name">&quot;eTorches/TimedTorches.start_flashing&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="206445683720842">
                            <conditions>
                                <condition id="-14" name="Pick by unique ID" sid="652812188545640" type="obj_timed_torch_handler">
                                    <param id="0" name="Unique ID">Function.Param(0)</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="512113655268466">
                                    <conditions>
                                        <condition id="-10" name="For" sid="145202226330953" type="System">
                                            <param id="0" name="Name">&quot;&quot;</param>
                                            <param id="1" name="Start index">0</param>
                                            <param id="2" name="End index">tokencount(obj_timed_torch_handler.torch_uids, &quot;|&quot;) - 1</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="726913976664998">
                                            <conditions>
                                                <condition id="-14" name="Pick by unique ID" sid="642911392664614" type="spr_torch">
                                                    <param id="0" name="Unique ID">int(tokenat(obj_timed_torch_handler.torch_uids, loopindex, &quot;|&quot;))</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action behavior="Flash" id="0" name="Flash" sid="408937896016015" type="spr_torch">
                                                    <param id="0" name="&apos;On&apos; time">0.3</param>
                                                    <param id="1" name="&apos;Off&apos; time">0.1</param>
                                                    <param id="2" name="Duration">obj_timed_torch_handler.time_to_light - 1</param>
                                                </action>
                                                <action behavior="Timer" id="0" name="Start timer" sid="104747661445900" type="spr_torch">
                                                    <param id="0" name="Duration">obj_timed_torch_handler.time_to_light - 1</param>
                                                    <param id="1" name="Type">0</param>
                                                    <param id="2" name="Tag">&quot;quick_flash&quot;</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="101872970877051">
                    <conditions>
                        <condition behavior="Timer" id="0" name="On timer" sid="888310482962291" type="spr_torch">
                            <param id="0" name="Tag">&quot;quick_flash&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="187913857908416">
                            <conditions>
                                <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="488478498200427" type="spr_torch">
                                    <param id="0" name="Instance variable">is_lit</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="Flash" id="0" name="Flash" sid="532566834422421" type="spr_torch">
                                    <param id="0" name="&apos;On&apos; time">0.08</param>
                                    <param id="1" name="&apos;Off&apos; time">0.08</param>
                                    <param id="2" name="Duration">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
